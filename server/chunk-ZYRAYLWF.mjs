import './polyfills.server.mjs';
import{a as z}from"./chunk-BEZY2WRY.mjs";import{a as Q}from"./chunk-LYTD37HZ.mjs";import{a as K}from"./chunk-C2EAKYVW.mjs";import{a as G}from"./chunk-BRHLG4NQ.mjs";import{a as H}from"./chunk-PRADOJUI.mjs";import{c as j,d as q}from"./chunk-G2EMQGJ6.mjs";import"./chunk-QGBB7THX.mjs";import{n as U}from"./chunk-UTIOHHII.mjs";import{Ac as V,Fb as k,Fc as $,Gb as D,Ma as t,Mb as l,Na as E,Nb as p,Za as _,ab as d,ca as N,eb as r,fb as i,gb as B,jb as P,la as y,lb as b,ma as I,nb as g,wb as o,xb as u,yb as m,yc as F,zb as O,zc as M}from"./chunk-RDXAN74U.mjs";import"./chunk-5XUXGTUW.mjs";var X=()=>[];function J(n,a){n&1&&(r(0,"span",32),o(1,"\u2714"),i())}function Y(n,a){n&1&&(r(0,"span",33),o(1,"\u2718"),i())}function Z(n,a){if(n&1&&(r(0,"p",34)(1,"strong"),o(2),l(3,"translate"),i(),o(4),l(5,"translate"),i()),n&2){let e=g().$implicit;t(2),u(p(3,2,"RESULTS.FEEDBACK")),t(2),m(" ",e.feedback_variable||p(5,4,"NO_FEEDBACK")," ")}}function ee(n,a){n&1&&(r(0,"span",32),o(1,"\u2714"),i())}function te(n,a){n&1&&(r(0,"span",33),o(1,"\u2718"),i())}function ie(n,a){if(n&1&&(r(0,"p",34)(1,"strong"),o(2),l(3,"translate"),i(),o(4),l(5,"translate"),i()),n&2){let e=g().$implicit;t(2),u(p(3,2,"RESULTS.FEEDBACK")),t(2),m(" ",e.feedback_value||p(5,4,"NO_FEEDBACK")," ")}}function ne(n,a){n&1&&(r(0,"span",32),o(1,"\u2714"),i())}function ae(n,a){n&1&&(r(0,"span",33),o(1,"\u2718"),i())}function re(n,a){if(n&1&&(r(0,"p",34)(1,"strong"),o(2),l(3,"translate"),i(),o(4),l(5,"translate"),i()),n&2){let e=g().$implicit;t(2),u(p(3,2,"RESULTS.FEEDBACK")),t(2),m(" ",e.feedback_recomend||p(5,4,"NO_FEEDBACK")," ")}}function oe(n,a){n&1&&(r(0,"p",35),o(1),l(2,"translate"),i()),n&2&&(t(),u(p(2,1,"RESULTS.NOT_GRAPHED")))}function se(n,a){if(n&1){let e=P();r(0,"div",36)(1,"app-line-chart",37),b("chartRendered",function(c){y(e);let f=g(3);return I(f.onChartRendered(c))}),i()()}if(n&2){let e=g().$implicit,s=g(2);t(),d("chartData",s.getChartData(e.id))("linguisticVariable",s.getChartData(e.id).linguisticVariable)}}function le(n,a){n&1&&B(0,"hr",38)}function pe(n,a){if(n&1&&(r(0,"li",22)(1,"p")(2,"strong",23),o(3),l(4,"translate"),i(),o(5),i(),r(6,"div",24)(7,"strong",23),o(8),l(9,"translate"),i(),r(10,"span",25),o(11),i(),r(12,"span"),_(13,J,2,0,"span",26)(14,Y,2,0,"span",27),i()(),_(15,Z,6,6,"p",28),r(16,"div",24)(17,"strong",23),o(18),l(19,"translate"),i(),r(20,"span",25),o(21),i(),r(22,"span"),_(23,ee,2,0,"span",26)(24,te,2,0,"span",27),i()(),_(25,ie,6,6,"p",28),r(26,"div",24)(27,"strong",23),o(28),l(29,"translate"),i(),r(30,"span",25),o(31),i(),r(32,"span"),_(33,ne,2,0,"span",26)(34,ae,2,0,"span",27),i()(),_(35,re,6,6,"p",28)(36,oe,3,3,"p",29)(37,se,2,2,"div",30)(38,le,1,0,"hr",31),i()),n&2){let e=a.$implicit,s=a.last,c=g(2);t(3),m("",p(4,20,"QUESTION.NFR"),":"),t(2),m(" ",e.nfr," "),t(3),u(p(9,22,"MODAL_CONFIRMATION.LINGUISTIC_VARIABLE")),t(3),m("(",e.user_variable,")"),t(2),d("ngIf",e.correct_variable),t(),d("ngIf",!e.correct_variable),t(),d("ngIf",!e.correct_variable),t(3),u(p(19,24,"MODAL_CONFIRMATION.LINGUISTIC_VALUE")),t(3),m("(",e.user_value,")"),t(2),d("ngIf",e.correct_value),t(),d("ngIf",!e.correct_value),t(),d("ngIf",!e.correct_value),t(3),u(p(29,26,"MODAL_CONFIRMATION.LINGUISTIC_RECOMMENDATION")),t(3),m("(",e.user_recomend,")"),t(2),d("ngIf",e.correct_recomend),t(),d("ngIf",!e.correct_recomend),t(),d("ngIf",!e.correct_recomend),t(),d("ngIf",!c.graphicExists(e.id)),t(),d("ngIf",c.graphicExists(e.id)),t(),d("ngIf",!s)}}function ce(n,a){if(n&1){let e=P();r(0,"div",12)(1,"div",13)(2,"div",14)(3,"h3",15),o(4),l(5,"translate"),i()(),r(6,"div",16)(7,"ul",17),_(8,pe,39,28,"li",18),i()(),r(9,"div",19)(10,"button",20),b("click",function(){y(e);let c=g();return I(c.closeModal())}),o(11),l(12,"translate"),i(),r(13,"button",21),b("click",function(){y(e);let c=g();return I(c.printResults())}),o(14),l(15,"translate"),i()()()()}if(n&2){let e=g();t(4),u(p(5,4,"TABLE.ANSWERS")),t(4),d("ngForOf",e.selectedAnswers),t(3),m(" ",p(12,6,"ALERT.BUTTON_CLOSE")," "),t(3),m(" ",p(15,8,"ALERT.PRINT")," ")}}function de(n,a){if(n&1){let e=P();r(0,"tr",39)(1,"td",40),o(2),i(),r(3,"td",40),o(4),i(),r(5,"td",40),o(6),i(),r(7,"td",40),o(8),i(),r(9,"td",40),o(10),i(),r(11,"td",40)(12,"button",41),b("click",function(){let c=y(e).$implicit,f=g();return I(f.openAnswersModal(c.answered_questions,c))}),o(13),l(14,"translate"),i()()()}if(n&2){let e=a.$implicit;t(2),u(e.id),t(2),u(e.code),t(2),u(e.score),t(2),O("",e.surnames," ",e.names,""),t(2),u(e.duration),t(3),m(" ",p(14,7,"TABLE.VIEW_ANSWERS")," ")}}function me(n,a){if(n&1){let e=P();r(0,"button",42),b("click",function(){let c=y(e).index,f=g();return I(f.goToPage(c+1))}),o(1),i()}if(n&2){let e=a.index,s=g();d("ngClass",s.currentPage===e+1?"bg-[#0D92F4] text-white border-blue-500":"bg-gray-100 text-gray-500 border-gray-300 hover:bg-gray-200 hover:text-gray-700"),t(),m(" ",e+1," ")}}function ge(n,a){n&1&&(r(0,"div",43)(1,"div",44),B(2,"div",45),i()())}var R=class n{constructor(a,e,s,c,f){this.gameRoomsService=a;this.alertService=e;this.loadingService=s;this.route=c;this.graficChartService=f}participatingPlayers=[];paginatedData=[];currentPage=1;itemsPerPage=10;showModal=!1;selectedAnswers=[];gameHistoryPrint={};areAllChartsRendered=!1;print=!1;graficas=[];gameRoomId=0;ngOnInit(){this.loadingService.showLoading(),this.gameRoomId=Number(this.route.snapshot.paramMap.get("id")),this.gameRoomsService.getParticipatingPlayersByGameRoom(this.gameRoomId).subscribe({next:a=>{this.loadingService.hideLoading(),this.participatingPlayers=a.data,this.updatePagination()},error:a=>{this.loadingService.hideLoading(),this.alertService.showAlert(a.message,!0)}})}updatePagination(){let a=(this.currentPage-1)*this.itemsPerPage,e=a+this.itemsPerPage;this.paginatedData=this.participatingPlayers.slice(a,e)}goToPage(a){this.currentPage=a,this.updatePagination()}nextPage(){this.currentPage*this.itemsPerPage<this.participatingPlayers.length&&(this.currentPage++,this.updatePagination())}prevPage(){this.currentPage>1&&(this.currentPage--,this.updatePagination())}get totalPages(){return Math.ceil(this.participatingPlayers.length/this.itemsPerPage)}openAnswersModal(a,e){this.selectedAnswers=a,this.gameHistoryPrint=e,this.graficChartService.getGraficByRoomAndQuestionAndUser(this.gameRoomId,-1,e.user_id).subscribe(s=>{s.data.length>0&&(this.graficas=s.data),this.showModal=!0},s=>{console.error("Error al obtener la gr\xE1fica:",s.message)})}onChartRendered(a){let e=document.createElement("img");e.src=a.toDataURL(),e.style.width="100%",e.style.height="auto",e.style.display="block",e.style.marginLeft="auto",e.style.marginRight="auto",a.parentNode?.replaceChild(e,a)}closeModal(){this.print=!1,this.showModal=!1,this.selectedAnswers=[],this.gameHistoryPrint={}}printResults(){this.print=!0;let a=setInterval(()=>{let e=document.getElementById("print-content"),s=e?.getElementsByTagName("img");if(this.areAllChartsRendered=s?.length==this.graficas.length,this.areAllChartsRendered){clearInterval(a);let c=this.gameHistoryPrint,f=c.score,T=c.names,w=c.surnames,W=c.duration,L=c.code;if(e){document.title=`Resultados - ${w} ${T} - ${L}`;let A=e?.getElementsByTagName("img");if(A)for(let h=0;h<A.length;h++){let v=A[h];v.style.width="90%",v.style.height="40%",v.style.marginTop="20px",v.style.marginBottom="20px"}let x=document.createElement("iframe");x.style.position="absolute",x.style.width="0",x.style.height="0",x.style.border="none",document.body.appendChild(x);let C=x.contentWindow?.document||x.contentDocument;C&&(C.open(),C.write(`
              <html>
                <head>
                <title>Resultados - ${w} ${T} - ${L}</title>
                  <style>
                    body {
                      font-family: Arial, sans-serif;
                      margin: 20px;
                      color: #4a5568;
                    }
                    .header {
                      margin-bottom: 20px;
                      border-bottom: 1px solid #e2e8f0;
                      position: relative;
                    }
                    .score-box {
                      position: absolute;
                      top: 0;
                      right: 10px;
                      padding: 10px;
                      border: 2px solid #4a5568;
                      font-weight: bold;
                      font-size: 16px;
                      text-align: center;
                      color: #4a5568;
                      background-color: #f1f5f9;
                    }
                    .font-bold {
                      font-weight: bold;
                    }
                    .text-gray-700 {
                      color: #4a5568;
                    }
                    .text-green-500 {
                      color: #48bb78;
                    }
                    .text-red-500 {
                      color: #f56565;
                    }
                    .text-sm {
                      font-size: 0.875rem;
                    }
                  </style>
                </head>
                <body>
                  <div class="header">
                    <div class="score-box">
                      SCORE<br>${f} / 100
                    </div>
                    <h2 class="font-bold text-gray-700">Resultado</h2>
                    <p><strong>Nombres:</strong> ${T}</p>
                    <p><strong>Apellidos:</strong> ${w}</p>
                    <p><strong>Duraci\xF3n:</strong> ${W}</p>
                    <p><strong>C\xF3digo de sala:</strong> ${L}</p>
                  </div>
                  ${e.outerHTML}
                </body>
              </html>
            `),C.close()),x.onload=()=>{x.contentWindow?.print(),document.title="FRUIT",document.body.removeChild(x);let h=e?.getElementsByTagName("img");if(h)for(let v=0;v<h.length;v++){let S=h[v];S.style.width="100%",S.style.height="auto",S.style.marginTop="0px",S.style.marginBottom="0px"}}}else console.error("No se encontr\xF3 el contenido a imprimir.")}},500)}graphicExists(a){return this.graficas.some(e=>e.question_id==a)}getChartData(a){return this.graficas.find(e=>e.question_id==a).data}static \u0275fac=function(e){return new(e||n)(E(z),E(H),E(G),E(U),E(K))};static \u0275cmp=N({type:n,selectors:[["app-participants-list"]],standalone:!0,features:[k],decls:35,vars:30,consts:[["class","fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",4,"ngIf"],[1,"py-10"],[1,"bg-white","shadow-md","rounded-lg","overflow-hidden"],[1,"overflow-x-auto"],[1,"min-w-full","table-auto"],[1,"bg-[#0D92F4]","text-white"],[1,"px-4","py-3","text-left","text-sm","font-medium","uppercase","tracking-wider","whitespace-nowrap"],["class","odd:bg-gray-50 even:bg-gray-100 hover:bg-gray-200",4,"ngFor","ngForOf"],[1,"flex","justify-center","items-center","mt-6","space-x-2"],[1,"px-4","py-2","text-sm","font-medium","text-gray-500","bg-gray-100","border","border-gray-300","rounded-md","hover:bg-gray-200","hover:text-gray-700","transition-colors","duration-300",3,"click","disabled","ngClass"],["class","px-4 py-2 text-sm font-medium border rounded-md transition-colors duration-300",3,"ngClass","click",4,"ngFor","ngForOf"],["class","fixed inset-0 z-50 bg-black bg-opacity-50 flex items-center justify-center",4,"ngIf"],[1,"fixed","inset-0","flex","items-center","justify-center","z-50","bg-black","bg-opacity-50"],[1,"bg-white","rounded-lg","shadow-lg","w-5/6","max-w-3xl"],[1,"px-4","pt-4","border-b","border-gray-200"],[1,"text-xl","font-bold","text-gray-800","m-0"],[1,"p-6","max-h-[70vh]","overflow-y-auto"],["id","print-content",1,"space-y-6"],["class","text-gray-700",4,"ngFor","ngForOf"],[1,"p-4","border-t","border-gray-200","flex","justify-end"],[1,"px-6","py-2","bg-red-500","text-white","text-sm","font-semibold","rounded-lg","shadow","hover:bg-red-600","focus:outline-none","focus:ring","focus:ring-red-300","transition",3,"click"],[1,"ml-4","px-6","py-2","bg-blue-500","text-white","text-sm","font-semibold","rounded-lg","shadow","hover:bg-blue-600","focus:outline-none","focus:ring","focus:ring-blue-300","transition",3,"click"],[1,"text-gray-700"],[1,"font-semibold"],[1,"flex","items-center","space-x-2"],[1,"text-sm","text-gray-600"],["class","text-green-500 text-lg font-bold",4,"ngIf"],["class","text-red-500 text-lg font-bold",4,"ngIf"],["class","text-sm text-red-500",4,"ngIf"],["class","italic border border-gray-400 text-gray-400 rounded-md px-2 py-1 inline-block",4,"ngIf"],["class","mb-4 bg-white rounded-md p-4",4,"ngIf"],["class","mt-6 border-t border-gray-300",4,"ngIf"],[1,"text-green-500","text-lg","font-bold"],[1,"text-red-500","text-lg","font-bold"],[1,"text-sm","text-red-500"],[1,"italic","border","border-gray-400","text-gray-400","rounded-md","px-2","py-1","inline-block"],[1,"mb-4","bg-white","rounded-md","p-4"],[3,"chartRendered","chartData","linguisticVariable"],[1,"mt-6","border-t","border-gray-300"],[1,"odd:bg-gray-50","even:bg-gray-100","hover:bg-gray-200"],[1,"px-4","py-4","text-sm","text-gray-700","whitespace-nowrap"],[1,"px-4","py-2","bg-blue-500","text-white","rounded-lg","hover:bg-blue-600","transition-colors","duration-300",3,"click"],[1,"px-4","py-2","text-sm","font-medium","border","rounded-md","transition-colors","duration-300",3,"click","ngClass"],[1,"fixed","inset-0","z-50","bg-black","bg-opacity-50","flex","items-center","justify-center"],[1,"rounded-lg","p-8"],[1,"animate-spin","rounded-full","h-20","w-20","border-t-4","border-blue-500","border-solid"]],template:function(e,s){e&1&&(_(0,ce,16,10,"div",0),r(1,"div",1)(2,"div",2)(3,"div",3)(4,"table",4)(5,"thead",5)(6,"tr")(7,"th",6),o(8," Id"),i(),r(9,"th",6),o(10),l(11,"translate"),i(),r(12,"th",6),o(13),l(14,"translate"),i(),r(15,"th",6),o(16),l(17,"translate"),i(),r(18,"th",6),o(19),l(20,"translate"),i(),r(21,"th",6),o(22),l(23,"translate"),i()()(),r(24,"tbody"),_(25,de,15,9,"tr",7),i()()()(),r(26,"div",8)(27,"button",9),b("click",function(){return s.prevPage()}),o(28),l(29,"translate"),i(),_(30,me,2,2,"button",10),r(31,"button",9),b("click",function(){return s.nextPage()}),o(32),l(33,"translate"),i()()(),_(34,ge,3,0,"div",11)),e&2&&(d("ngIf",s.showModal),t(10),m(" ",p(11,15,"TABLE.CODE"),""),t(3),m(" ",p(14,17,"TABLE.SCORE"),""),t(3),m(" ",p(17,19,"TABLE.FULL_NAME"),""),t(3),m(" ",p(20,21,"TABLE.DURATION"),""),t(3),m(" ",p(23,23,"TABLE.ANSWERS"),""),t(3),d("ngForOf",s.paginatedData),t(2),d("disabled",s.currentPage===1)("ngClass",s.currentPage===1?"opacity-50 cursor-not-allowed":""),t(),m(" \xAB ",p(29,25,"BUTTON_NAVIGATION_TABLE.PREVIOUS")," "),t(2),d("ngForOf",D(29,X).constructor(s.totalPages)),t(),d("disabled",s.currentPage===s.totalPages)("ngClass",s.currentPage===s.totalPages?"opacity-50 cursor-not-allowed":""),t(),m(" ",p(33,27,"BUTTON_NAVIGATION_TABLE.NEXT"),"\xBB "),t(2),d("ngIf",s.print&&!s.areAllChartsRendered))},dependencies:[$,F,M,V,q,j,Q]})};export{R as default};
